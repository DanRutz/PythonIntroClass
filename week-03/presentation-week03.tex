\documentclass{beamer}
%\usepackage[latin1]{inputenc}
\usetheme{Warsaw}
\title[Intro to Python: Week 2]{Introduction  to Python\\ Exceptions, Unicode, Text Processing}
\author{Christopher Barker}
\institute{UW Continuing Education / Isilon}
\date{July 11, 2012}

\usepackage{listings}
\usepackage{hyperref}

\begin{document}

% ---------------------------------------------
\begin{frame}
  \titlepage
\end{frame}

% ---------------------------------------------
\begin{frame}
\frametitle{Table of Contents}
%\tableofcontents[currentsection]
  \tableofcontents
\end{frame}

\section{Review/Questions}


%-------------------------------
\begin{frame}{title}

{\Large Lab from end of last class?  }

\end{frame}


%-------------------------------
\begin{frame}[fragile]{LAB}

\verb| def count_them(letter): |
\begin{itemize}
  \item prompts the user to input a letter
  \item counts the number of times the given letter is input
  \item prompts the user for another letter
  \item continues until the user inputs "x"
  \item returns the count of the letter input
\end{itemize}

\verb| def count_letter_in_string(string, letter): |
\begin{itemize}
  \item counts the number of instances of the letter in the string
  \item ends when a period is encountered
  \item if no period is encountered -- prints "hey, there was no period!"
\end{itemize}
\end{frame}


% ---------------------------------------------
\begin{frame}{Questions?}

{\Large Any Questions about:
\begin{itemize}
  \item Last class ?
  \item Reading ?
  \item Homework ?
\end{itemize}
}
\end{frame}


% header
% ---------------------------------------------
\begin{frame}{Homework review}

  {\Large Homework notes }

\end{frame}

\section {Notes on Reading}

%-------------------------------
\begin{frame}[fragile]{subprocesses}

{\Large Subprocesses}
\begin{verbatim}
#easy:  
os.popen('ls').read()

#even easier:
os.system('ls')

# but for anything more complicated:
pipe = \
  subprocess.Popen("ls", stdout=subprocess.PIPE).stdout 
\end{verbatim}

\end{frame}


%-------------------------------
\begin{frame}[fragile]{reload}

{\Large module importing and reloading}
\begin{verbatim}
In [190]: import module_reload

In [191]: module_reload.print_something()
I'm printing something

# change it...
In [196]: reload(module_reload)
Out[196]: <module 'module_reload' from 'module_reload.py'>

In [193]: module_reload.print_something()
I'm printing something else
\end{verbatim}

\end{frame}

% ---------------------------------------------
\begin{frame}[fragile]{Module Reloading}

\begin{verbatim}
In [194]: from module_reload import this

# change it...

In [196]: reload(module_reload)
Out[196]: <module 'module_reload' from 'module_reload.py'>

In [197]: module_reload.this
Out[197]: 'this2'

In [198]: this
Out[198]: 'this'
\end{verbatim}

\end{frame}

% ---------------------------------------------
\begin{frame}[fragile]{repr vs. str}

{\Large \verb|repr()| vs \verb|str()| }

\begin{verbatim}
In [200]: s = "a string\nwith a newline"

In [203]: print str(s)
a string
with a newline

In [204]: print repr(s)
'a string\nwith a newline'

\end{verbatim}

\end{frame}

% ---------------------------------------------
\begin{frame}[fragile]{repr vs. str}

{\Large \verb| eval(repr(something)) == something | }

\begin{verbatim}

In [205]: s2 = eval(repr(s))

In [206]: s2
Out[206]: 'a string\nwith a newline'
\end{verbatim}

\end{frame}


\section{More on Strings}

% ---------------------------------------------
\begin{frame}[fragile]{Strings}

{\Large A string literal creates a string type}

\begin{verbatim}
"this is a string"
\end{verbatim}

{\Large Can also use \verb|str()|}

\begin{verbatim}
In [256]: str(34)
Out[256]: '34'
\end{verbatim}
{\Large or "back ticks"}
\begin{verbatim}
In [258]: `34`
Out[258]: '34'
\end{verbatim}
(demo)
\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{The String Type}

{\Large Lots of nifty methods:}

\begin{verbatim}
s.lower()
s.upper()
     ...
s.capitalize()
s.swapcase()
s.title()
\end{verbatim}

\url{http://docs.python.org/library/stdtypes.html#index-23}

\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{The String Type}

{\Large Lots of nifty methods:}

\begin{verbatim}
x in s
s.startswith(x)
s.endswith
...
s.index(x)
s.find(x)
s.rfind(x)
\end{verbatim}

\url{http://docs.python.org/library/stdtypes.html#index-23}

\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{The String Type}

{\Large Lots of nifty methods:}

\begin{verbatim}
s.split()
s.join(list)
...
s.splitlines()
\end{verbatim}

\url{http://docs.python.org/library/stdtypes.html#index-23}
\vfill
(demo -- join)

\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{String Literals}
{\Large Common Escape Sequences}
\vfill
\begin{verbatim}
\\ 	Backslash (\) 	
\a 	ASCII Bell (BEL) 	
\b 	ASCII Backspace (BS) 	
\n 	ASCII Linefeed (LF) 	
\r 	ASCII Carriage Return (CR) 	
\t 	ASCII Horizontal Tab (TAB) 	
\ooo 	Character with octal value ooo 
\xhh 	Character with hex value hh
\end{verbatim}
(\url{http://docs.python.org/release/2.5.2/ref/strings.html})
\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{Raw Strings}

{\Large Escape Sequences Ignored}
\vfill
\begin{verbatim}
In [408]: print "this\nthat"
this
that
In [409]: print r"this\nthat"
this\nthat
\end{verbatim}

{\Large Gotcha:}
\begin{verbatim}
In [415]: r"\"
SyntaxError: EOL while scanning string literal
\end{verbatim}

(\url{http://docs.python.org/release/2.5.2/ref/strings.html})
\end{frame} 


% ---------------------------------------------
\begin{frame}[fragile]{Building Strings}

{\Large Please don't do this:

\vfill
\begin{verbatim}
'Hello ' + name + '!'
\end{verbatim}
}
\vfill
(much)

\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{Building Strings}

{\Large Do this instead:

\vfill
\begin{verbatim}
'Hello %s!' % name
\end{verbatim}

\vfill
much faster and safer: \\
easier to modify as code gets complicated
}
\url{http://docs.python.org/library/stdtypes.html#string-formatting-operations}
\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{Joining Strings}

{\Large The Join Method:}

\vfill
\begin{verbatim}
In [289]: t = ("some", "words","to","join")

In [290]: " ".join(t)
Out[290]: 'some words to join'

In [291]: ",".join(t)
Out[291]: 'some,words,to,join'

In [292]: "".join(t)
Out[292]: 'somewordstojoin'

In [293]: "\n".join(t)
Out[293]: 'some\nwords\nto\njoin'

\end{verbatim}

\vfill
\end{frame} 




% ---------------------------------------------
\begin{frame}[fragile]{String Formatting}

{\Large The string format operator: \%}

\begin{verbatim}
In [261]: "an integer is: %i"%34
Out[261]: 'an integer is: 34'

In [262]: "a floating point is: %f"%34.5
Out[262]: 'a floating point is: 34.500000'

In [263]: "a string is: %s"%"anything"
Out[263]: 'a string is: anything'
\end{verbatim}

\end{frame} 

% ---------------------------------------------
\begin{frame}[fragile]{String Formatting}

{\Large multiple arguments:}

\begin{verbatim}
In [264]: "the number %s is %i"%('five', 5)
Out[264]: 'the number five is 5'

In [266]: "the first 5 numbers are: %i, %i, %i, %i, %i"%(1,2,3,4,5)
Out[266]: 'the first 5 numbers are: 1, 2, 3, 4, 5'

\end{verbatim}

\end{frame} 

%-------------------------------
\begin{frame}[fragile]{String formatting}

{\Large Gotcha}

\begin{verbatim}
In [127]: "this is a string with %i formatting item"%1 
Out[127]: 'this is a string with 1 formatting item'

In [128]: "string with %i formatting %s: "%2, "items" 
TypeError: not enough arguments for format string

# Done right:
In [131]: "string with %i formatting %s"%(2, "items")
Out[131]: 'string with 2 formatting items'

In [132]: "string with %i formatting item"%(1,)
Out[132]: 'string with 1 formatting item' 
\end{verbatim}

\end{frame}

%-------------------------------
\begin{frame}[fragile]{String formatting}

{\Large Named arguments}

\begin{verbatim}
'Hello %(name)s!'%{'name':'Joe'}
'Hello Joe!'

'Hello %(name)s, how are you, %(name)s!' %{'name':'Joe'}
'Hello Joe, how are you, Joe!'
\end{verbatim}
\vfill
{\Large That last bit is a dictionary (next week) }

\end{frame}

%-------------------------------
\begin{frame}[fragile]{Advanced Formatting}

{\Large The format method}

\begin{verbatim}
In [283]: 'Hello {0}!'.format(name)
Out[283]: 'Hello Joe!'

In [284]: 'Hello {name}!'.format(**dictionary)
Out[284]: 'Hello Joe!'
\end{verbatim}
\vfill
{\Large pick one (probably ‘string formatting’): \\
 get comfy with it }

\end{frame}


%-------------------------------
\begin{frame}[fragile]{LAB}

{\Large Format operators:}

\begin{itemize}
  \item rewrite: \verb| the first 3 numbers are: %i, %i, %i"%(1,2,3)| \\
        for an arbitrary number of numbers...

\end{itemize}

\end{frame}

\section{Files}

%-------------------------------
\begin{frame}[fragile]{Files}

{\Large Text Files}

\begin{verbatim}
f = open('secrets.txt')
secret_data = f.read()
f.close()
\end{verbatim}

{\Large \verb|secret_data| is a string}

\vfill
(can also use \verb|file()| -- \verb|open()| is preferred)
\end{frame}

%-------------------------------
\begin{frame}[fragile]{Files}

{\Large Binary Files}

\begin{verbatim}
f = open('secrets.txt', 'rb')
secret_data = f.read()
f.close()
\end{verbatim}

{\Large \verb|secret_data| is still a string \\[.1in]
(with arbitrary bytes in it)}
\vfill
(See the \verb|struct| module to unpack binary data )
\end{frame}

%-------------------------------
\begin{frame}[fragile]{Files}

{\Large File Opening Modes}
\vfill
\begin{verbatim}
f = open('secrets.txt', [mode])

'r', 'w', 'a'
'rb', 'wb', 'ab'
r+, w+, a+
r+b, w+b, a+b
U
U+
\end{verbatim}
\vfill
{\Large Gotcha -- w mode always clears the file}
\end{frame}

%-------------------------------
\begin{frame}[fragile]{Text File Notes}

{\Large Text is default}
\begin{itemize}
  \item Newlines are translated: \verb|\r\n -> \n|
  \item   -- reading and writing!
  \item Use *nux-style in your code: \verb|\n|
  \item Open text files with \verb|'U'| "Universal" flag
\end{itemize}

\vfill
{\Large Gotcha:}
\begin{itemize}
  \item  no difference between text and binary on *nix\\
  \begin{itemize}
    \item breaks on Windows
  \end{itemize}
\end{itemize}

\end{frame}

%-------------------------------
\begin{frame}[fragile]{File Reading}

{\Large Reading Part of a file}

\begin{verbatim}
header_size = 4096

f = open('secrets.txt')
secret_data = f.read(header_size)
f.close()
\end{verbatim}

\end{frame}

%-------------------------------
\begin{frame}[fragile]{File Reading}

{\Large Common Idioms}

\begin{verbatim}
for line in open('secrets.txt'):
    print line
\end{verbatim}

\begin{verbatim}
f = open('secrets.txt')
while True:
    line = f.readline()
    if not line: 
        break
    do_something_with_line()
\end{verbatim}

\end{frame}

%-------------------------------
\begin{frame}[fragile]{File Writing}

\begin{verbatim}

outfile = open('output.txt')

for i in range(10):
    outfile.write("this is line: %i\n"%i)

\end{verbatim}

\end{frame}

%-------------------------------
\begin{frame}[fragile]{File Methods}

{\Large Commonly Used Methods}
\begin{verbatim}

f.read() f.readline()  f.readlines() 

f.write(str) f.writelines(seq)
 
f.seek(offset)   f.tell()

f.flush()           
           
f.close() 
\end{verbatim}

\end{frame}

%-------------------------------
\begin{frame}[fragile]{File Like Objects}

{\Large File-like objects }
\vfill
{\large Many classes impliment the file interface:}
\vfill
\begin{itemize}
  \item loggers
  \item \verb|sys.stdout|
  \item \verb|urllib.open()|
  \item pipes, subprocesses
  \item StringIO
\end{itemize}

\url{￼http://docs.python.org/library/stdtypes.html#bltin-­‐file-­‐objects}
\end{frame}

%-------------------------------
\begin{frame}[fragile]{StringIO}

{\Large StringIO }
\vfill
\begin{verbatim}
In [417]: import StringIO
In [420]: f = StringIO.StringIO()

In [421]: f.write("somestuff")

In [422]: f.seek(0)

In [423]: f.read()
Out[423]: 'somestuff'
\end{verbatim}

{\Large handy for testing}
\end{frame}

\section{Exceptions}

\section{Unicode}

\begin{frame}[fragile]{Unicode}

{\Large Python Docs Unicode HowTo:}

\url{http://docs.python.org/howto/unicode.html}

Reading Unicode from a file is therefore simple:

\begin{verbatim}
import codecs
f = codecs.open('unicode.rst', encoding='utf-8')
for line in f:
    print repr(line)
\end{verbatim}



\end{frame}

\end{document}

 
